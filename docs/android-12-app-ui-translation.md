# Android 12 可能会自动将应用程序翻译成你的母语

> 原文：<https://www.xda-developers.com/android-12-app-ui-translation/>

Android 拥有超过 25 亿活跃用户，是全球使用最广泛的操作系统。虽然操作系统本身已经被本地化为几十种不同的语言，但许多第三方应用程序却并非如此。较大的公司可以在内部本地化他们的应用程序或者雇佣专业的翻译服务，但是这些选择对于较小的团队或者独立的应用程序开发者来说在经济上是不可行的。在最好的情况下，一个较小的团队或独立应用程序开发人员可以从母语人士那里众包翻译，在最坏的情况下，他们可以使用机器翻译服务来完成这项工作。然而，这可能会在 [Android 12](https://www.xda-developers.com/android-12/) 中发生变化，因为我们已经看到证据表明谷歌可能正在开发一个框架，用于自动将应用程序的 UI 翻译成用户的母语。

APK 拆卸通常可以预测应用程序未来更新中可能出现的功能，但我们在这里提到的任何功能都可能不会出现在未来的版本中。这是因为这些特性目前还没有在实时构建中实现，并且可能会被开发人员在未来的构建中随时引入。

本周早些时候，我们获得了一个未发布的 Android 12 版本，其中包含了几个[新功能和 UI 变化](https://www.xda-developers.com/android-12-beta-features-leak/)。在深入研究该版本时，我们发现了框架中与新的“翻译服务”相关的大量新类当我们发现这个版本的 Android 12 增加了两个新的权限时，我们的搜索就开始了:`BIND_TRANSLATION_SERVICE`和`MANAGE_UI_TRANSLATION`。Android 的 SystemUI 持有前一种权限，绑定到持有后一种权限的应用程序，后者默认由值`config_defaultTranslationService`定义。据推测，像谷歌翻译或设备个性化服务这样的应用程序可以设置为翻译服务，但谷歌可能会向第三方应用程序开放，因为`MANAGE_UI_TRANSLATION`权限将“角色”定义为受支持的保护级别之一。如果你还记得的话，Android 10 增加了“[角色](https://developer.android.com/reference/android/app/role/RoleManager)”，定义了应该拥有特定权限的应用程序；谷歌可能会添加“翻译”作为一个角色，但我们不知道这个角色是否可以授予用户安装的应用程序。

无论如何，我们在框架代码中找到了对这些权限的引用，在那里我们发现了新的翻译代码作用于活动中的视图而不是屏幕截图或最近应用面板的证据。谷歌镜头已经可以翻译截图或最近应用面板中的文本，结合设备个性化服务，可以从最近应用面板直接翻译文本[。与此同时，Android 的意图系统已经允许基本的文本共享翻译。然而，这个新框架似乎更加复杂和低级，我们认为它旨在直接翻译应用程序 UI 中的文本，取代内嵌文本，使翻译感觉更加自然。](https://www.xda-developers.com/android-12-recents-panel-adds-helpful-translate-suggestions/)

我们检查了谷歌翻译和设备个性化服务的最新版本，但没有发现任何集成这一新 API 的证据。这个 API 可能不会直接使用 Google Translate，而是使用不同的 API 端点。如果这项功能的实现符合我们的猜测，我们怀疑谷歌会为这项功能向用户收费。然而，他们可能会将谷歌翻译支持的 UI 翻译作为像素专属功能。不过，由于这个框架似乎要进入 AOSP，如果原始设备制造商不想使用谷歌的，他们可以定义自己的翻译服务。

像 AllTrans 这样的第三方应用多年来一直提供自己的 UI 翻译功能。在 Xposed 框架的支持下，这些 mod 的工作方式类似于我们认为 Android 12 的 UI 翻译工作方式，直接挂钩到应用程序的视图来翻译和替换文本。然而，这些 mod 要求用户为翻译服务获取自己的 API 密钥，因为共享密钥会很快超过免费限制。然而，随着谷歌似乎直接在 Android 12 中建立了一个 UI 翻译框架，用户将不再需要将他们的设备转换为他们的母语。这将有望使成千上万的应用程序更容易被全球用户使用。

使用 Xposed 框架，AllTrans 连接到应用程序中的文本视图，使用微软的翻译器翻译文本。

开发人员也将受益于自动化的 UI 翻译。没有资源翻译应用程序或不想使用机器翻译的开发人员可以让操作系统来处理事情。发布一个机器翻译的应用程序可能会导致用户的负面评论，他们会因为糟糕的翻译而指责开发人员，但让用户自己指导操作系统翻译应用程序将会减少挫折感，因为用户会更好地理解将任何糟糕的翻译文本归咎于何处。

虽然我们相当有信心这项功能旨在翻译应用程序中的用户界面，但在我们看到这项功能投入使用之前，我们不能 100%肯定这一点。该功能的另一种用途是在操作系统内或仅在系统应用中翻译 UI，但我们认为这不太可能，因为操作系统已经广泛本地化，任何本地化都可以在设备出厂前或通过 OTA 更新完成。另一方面，谷歌和原始设备制造商不能说明一个应用程序支持哪些语言，所以这个功能将有助于填补空白。考虑到谷歌正在视图级别开发这一功能，使其可以在所有应用程序中使用，也使其更有可能用于应用程序而不是操作系统。尽管如此，在这项功能发布之前，我们无法确定，这可能会在 Android 12 稳定版中发生，也可能不会发生。

*感谢开发者 [Quinny899](https://forum.xda-developers.com/m/quinny899.3563640/) 和 [kdrag0n](https://forum.xda-developers.com/m/kdrag0n.7291478/) 协助分析这段代码。也感谢 PNF 软件为我们提供了使用**[JEB Decompiler](https://www.pnfsoftware.com/?aid=xdadev)**的许可，这是一款针对 Android 应用的专业级逆向工程工具。*