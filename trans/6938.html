<html>
<head>
<title>ADB Tips &amp; Tricks: ADB commands that every power user should know about!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>亚行提示和技巧:亚行命令，每个电力用户都应该知道！</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/adb-tips-tricks/#0001-01-01">https://www.xda-developers.com/adb-tips-tricks/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>Android 为开发者提供了一个简洁的工具，叫做 Android Debug Bridge，简称 ADB。它在 Android Studio 中使用，由 Android 开发人员手动在 Android 智能手机和仿真设备上安装和测试应用程序。</p>

  
<p>但是亚行能做的事情很多，而且大部分不仅仅对开发人员有用。即使你不是开发人员，但你正在阅读这篇文章，你很可能已经使用过一两次 ADB 来安装一个应用程序或调整权限。但这并不是亚行的全部用途。继续阅读一些你可能不知道的使用 ADB 的提示和技巧。</p>



<section class="emaki-custom-block emaki-custom-note"><div class="emaki-custom note" id="custom_block_3"><p><strong>注意</strong>:你需要在你的电脑上安装并运行 ADB。如果你需要帮助，一定要看看我们关于<a href="https://www.xda-developers.com/install-adb-windows-macos-linux/">如何安装 ADB </a>的文章。</p> </div></section>
<hr/>


<h2 id="shell-access">外壳访问</h2>
<p>如果你以前使用过 ADB，你可能习惯于在一行中运行所有的命令。但是你也可以使用 ADB 在你的设备上打开一个终端外壳，直接运行命令。而且很简单！</p>

<p>在终端或命令提示符窗口中:</p>

<p><code>adb shell</code></p>

<p>然后你会看到一个<code>$</code>符号，你可以直接在你的设备上运行命令。</p>



<hr/>
<p class="ad-odd"> </p>


<h2 id="listing-installed-apps-through-adb">通过 ADB 列出已安装的应用程序</h2>
<p>若要查看设备上已安装的应用程序，您可以使用以下命令:</p>

<p><code>adb shell pm list packages</code></p>

<p>这将返回一个已安装应用程序的包名列表，每个包名都有自己的前缀<code>package:</code>。</p>



<h3 id="options">选择</h3>
<p>还有一些选项可以用来检索更具体的列表。</p>

<ul> <li><strong> -f </strong>将包括每个应用程序的基本 APK 的路径，以及它的包名。</li> <li><strong> -a </strong>将确保返回所有已知的非 APEX 包。</li> <li><strong> -d </strong>将导致命令仅返回禁用的包。</li> <li><strong> -e </strong>将使命令只返回已启用的包。</li> <li><strong> -s </strong>将导致命令只返回系统包。</li> <li><strong> -3 </strong>将导致命令只返回第三方包。</li> <li><strong> -i </strong>将包含每个包的安装包名称。</li> <li><strong> -U </strong>将包含每个包的包 UID。</li> <li><strong> -u </strong>将包含未安装的软件包。</li> <li><strong> - show-versioncode </strong>将包含每个包的版本代码。</li> <li><strong> -仅 apex</strong>将仅返回 APEX 包。</li> <li><strong> - uid &lt; uid &gt; </strong>只会显示给定 UID 的包。</li> <li><strong> -用户&lt;用户标识&gt; </strong>将只显示属于给定用户标识的包。</li> </ul>

<hr/>
<p class="ad-even"> </p>


<h2 id="installing-amp-uninstalling-apps-through-adb">通过 ADB 安装和卸载应用程序</h2>
<p>这是亚行比较常见的用法，但无论如何还是值得一提。除此之外，你还可以利用 ADB 在你的 Android 设备上安装和卸载 Android 应用程序。</p>

<h3 id="installing-an-apk">安装 APK</h3>
<p>如果您的电脑上有 APK，您可以通过以下方式将其安装到您的设备上:</p>

<p><code>adb install -r someapk.apk</code></p>

<p>记得用您想要安装的 APK 的完整路径替换<code>someapk.apk</code>。</p>

<h3 id="options">选择</h3>
<p>通过 ADB 安装 apk 有很多选择。</p>

<ul> <li><strong> -r </strong>选项允许 ADB 在现有应用程序上进行安装(即更新)。在 Android Pie 和更高版本上，您不必指定此选项。</li> <li>对于 Android Pie 和更高版本，<strong> -R </strong>选项将导致安装失败，如果应用程序已经安装。</li> <li><strong> -i </strong>选项允许您指定安装程序包的名称。如果 Android 想知道是什么安装了 APK，就会返回这个信息。</li> <li><strong> -t </strong>选项允许安装清单中带有<strong> android:testOnly="true" </strong>的 APK。</li> <li><strong> -d </strong>选项允许将指定的 APK 降级到已经安装的应用程序。这只有在应用程序的两个版本都可以调试的情况下才有效。</li> <li>Android Marshmallow 和更高版本的<strong> -g </strong>选项会自动将所有运行时权限授予已安装的应用程序。</li> </ul>

<p>这还不是全部。如果您想要一个完整的列表，您可以查看内置文档。</p>

<h3 id="multiple-apks-and-bundles">多个 apk 和捆绑包</h3>
<p>如果你有一堆你想一次安装的 apk，或者来自多个应用，或者因为你正在安装一个应用捆绑包，你可以使用 ADB 的<code>install-multiple</code>和<code>install-multi-package</code>特性。</p>

<p>如果您的所有 apk 都用于一个应用程序，请使用<code>install-multiple</code>:</p>

<p><code>adb install-multiple apk1.apk apk2.apk ...</code></p>

<p>否则，使用<code>install-multi-package</code>:</p>

<p><code>adb install-multi-package app1.apk app2.apk ...</code></p>

<p>这些命令的选项与<code>install</code>相似，但有一些限制。查看亚行的内置文档，了解哪些选项可用。</p>

<h3 id="uninstalling-an-app">卸载应用程序</h3>
<p>若要使用 ADB 卸载，您需要要卸载的应用的软件包名称。如果您还没有安装应用程序，请查看<strong>部分。</strong></p>

<p>一旦有了软件包名称，卸载就非常简单:</p>

<p><code>adb uninstall &lt;packagename&gt;</code></p>

<p><strong>注意:</strong>您通常不能使用此命令卸载系统或预装的应用程序。但是，您可以使用 ADB 禁用它们。查看<strong>禁用&amp;启用几乎任何 App </strong>部分了解详情。</p>

<hr/>
<p class="ad-odd"> </p>



<p>你可能有很多理由想要为一个应用程序提取 APK。也许您想要备份它以供将来使用，或者也许它不再在线可用，您想要将其传输到不同的设备。</p>

<p>使用 ADB 提取应用程序非常简单。首先，您需要找到要提取的应用程序的包名。有多种方法可以做到这一点，但最简单的方法通常是使用您设备的设置应用程序来查看所有已安装应用程序的列表，选择您想要的应用程序，然后向下滚动，直到找到软件包名称或应用程序 ID。</p>

<p>获得包名后，运行以下命令:</p>

<p><code>adb shell pm path &lt;packagename&gt;</code></p>

<p>这个命令将返回该包名的所有 apk 的路径。</p>



<p>然后，您可以使用以下命令将每个 APK 提取到您的计算机:</p>

<p><code>adb pull /path/to/apk.apk</code></p>

<hr/>
<p class="ad-even"> </p>


<h2 id="listing-app-components">列出应用程序组件</h2>
<p>一个应用程序的组件包括活动、广播接收者、服务等等。有时，知道特定应用程序中这些组件的名称很有用，特别是如果您想要启动隐藏的活动或发送包含特定数据的广播。</p>

<p>不幸的是，亚行没有一个非常清晰的方法来列出一个应用程序的组件。但这是可能的。运行以下命令:</p>

<p><code>adb shell dumpsys package &lt;packagename&gt;</code></p>

<p>将返回一整串文本。</p>

<ul> <li>滚动直到找到<strong>活动解析器表</strong>标题，以查看活动。</li> <li>在<strong>接收器解析器表</strong>下查找广播接收器。</li> <li>检查<strong>服务解析器表</strong>中的服务。</li> <li>诸如此类。</li> </ul>

<p>每个组件将显示启动它所需的动作、组件的名称，可能还有一些额外的信息。</p>



<p>或者，如果你想更容易地查看活动、服务和接收者，你可以使用我的<a href="https://play.google.com/store/apps/details?id=tk.zwander.rootactivitylauncher">根活动启动器应用</a>。它将向您展示每个应用程序的组件，以及一系列其他方便的功能。</p>

<hr/>
<p class="ad-odd"> </p>


<h2 id="launching-activities-services-and-broadcastreceivers">启动活动、服务和广播接收器</h2>
<p>ADB 还可以用于发起活动、启动服务和通知广播接收者。如果需要，您甚至可以指定数据 URIs 和额外意图。</p>

<p>要启动组件，您需要要启动的组件的名称。您可以从<strong>列出应用程序组件</strong>部分了解如何获取。</p>

<p>启动活动的命令语法如下:</p>

<p><code>am start -a &lt;action&gt; -n &lt;component&gt;</code></p>

<p>启动服务的命令语法如下:</p>

<p><code>am startservice -a &lt;action&gt; -n &lt;component&gt;</code></p>

<p>通知 BroadcastReceiver 的命令语法如下:</p>

<p><code>am broadcast -a &lt;action&gt; -n &lt;component&gt;</code></p>

<p>在大多数情况下，对于活动和服务，您不需要显式地指定一个动作。通常，只有当组件使用的不是<strong>Android . intent . action . main</strong>时，才需要它。</p>

<p>在基本语法之上，下面是如何指定更多要传递的数据。通常，所有数据值都应该用双引号括起来。</p>

<ul> <li><strong> -d </strong>允许您指定一个数据 URI。</li> <li><strong> -e &lt;键&gt; &lt;值&gt; </strong>或<strong> - es &lt;键&gt; &lt;值&gt; </strong>允许您额外指定一个字符串。</li> <li><strong> - esn &lt;键&gt; </strong>允许您额外指定一个空字符串。</li> <li><strong> - ez &lt;键&gt; &lt;值&gt; </strong>用于指定一个额外的布尔。</li> <li><strong> - ei </strong> <strong> &lt;键&gt; &lt;值&gt; </strong>用于指定一个额外的整数。</li> <li><strong> - el &lt;键&gt; &lt;值&gt; </strong>用于指定一个长的额外值。</li> <li><strong> - ef &lt;键&gt; &lt;值&gt; </strong>会额外传递一个浮点数。</li> <li><strong> -欧盟&lt;键&gt; &lt;值&gt; </strong>通过一个 URI 额外的。</li> <li><strong> - ecn &lt;键&gt; &lt;值&gt; </strong>可以用来额外指定一个组件名。</li> <li><strong> -环评&lt;关键&gt; &lt;值 1 &gt;，&lt;值 2 &gt;，...</strong>将把值作为整数[]额外传递。</li> <li><strong> - eial &lt;键&gt; &lt;值 1 &gt;，&lt;值 2 &gt;，...</strong>将把值作为一个列表&lt;整数&gt;传递。</li> <li>同样的数组和列表参数也适用于长整型、浮点型和字符串型。只需用适当的字母替换<strong> i </strong>即可。</li> <li><strong> -f </strong>允许您指定一个标志。</li> </ul>

<p>您甚至可以使用更多的行为选项，所以请查看内置文档以了解详细信息。</p>

<hr/>
<p class="ad-even"> </p>


<h2 id="disabling-amp-enabling-almost-any-app">禁用和启用几乎任何应用程序</h2>
<p>Android 中的系统应用无法卸载，其中很多也无法通过设置禁用。虽然亚行不会让你卸载它们，但它可能会帮助你禁用它们。</p>

<p>首先，确保获得您想要禁用的应用程序的包名。然后，尝试这些命令。如果一个失败，尝试下一个选项。</p>

<ul> <li><strong> pm 禁用&lt;包&gt; </strong><ul> <li>要重新启用，使用<strong> pm enable &lt; package &gt; </strong></li> </ul> </li> <li><strong> pm disable-user - user 0 &lt;包&gt; </strong><ul> <li>要重新启用，使用<strong> pm enable &lt; package &gt; </strong></li> </ul> </li> <li><strong> pm 隐藏&lt;包&gt;T1】</strong><ul> <li>要重新启用，使用<strong> pm 取消隐藏&lt;包&gt; </strong></li> </ul> </li> <li><strong> pm 暂停&lt;包&gt;包</strong><ul> <li>要重新启用，使用<strong> pm 取消暂停&lt;包&gt; </strong></li> </ul> </li> <li><strong> pm 卸载-k -用户 0 &lt;包&gt; </strong><ul> <li>要重新启用，使用<strong> pm install-existing &lt;包&gt; </strong></li> <li>注意:这可以有效地从您的用户配置文件中卸载应用程序。虽然重新启用<em>的命令应该</em>工作，但不能保证它会。您可能需要恢复出厂设置来恢复应用程序。</li> </ul> </li> </ul>

<p>如果您在设备上使用多个用户配置文件，请确保用您拥有的实际用户 ID 替换上面命令中的<strong> 0 </strong>。</p>

<hr/>

<p>亚行是一个非常强大的工具，它能做的远不止这些。本文中的命令只是一个有用的起点。对于更高级的用法，请查看类似于<strong> cmd -l </strong>的命令，以查看您可能能够与之交互的不同服务，或者<strong> ls -l /system/bin </strong>以查看可用的不同命令可执行文件。</p>

 </div>


</div>    
</body>
</html>