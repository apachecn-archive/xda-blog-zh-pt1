<html>
<head>
<title>NFC smartphones enabled researchers to hack point of sale systems and ATMs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>NFC 智能手机使研究人员能够入侵销售点系统和自动取款机</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/smartphones-nfc-point-of-sale-atm-hack/#0001-01-01">https://www.xda-developers.com/smartphones-nfc-point-of-sale-atm-hack/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>尽管自动提款机是在旅途中从你的银行账户中取钱的唯一方式之一，但多年来，自动提款机一直存在一系列众所周知的安全问题。即使是现在，也没有什么能阻止黑客在自动取款机上放置套卡机，因为大多数人永远不会注意到它的存在。当然，这些年来也有许多比这更复杂的攻击，但总的来说，使用 ATM 时你应该始终小心。现在有了一种入侵自动取款机的新方法，只需要一部带 NFC 功能的智能手机。</p>

  
<p>据<a href="https://www.wired.com/story/atm-hack-nfc-bugs-point-of-sale/"> <em>《连线》</em> </a>报道，<a href="https://twitter.com/josep_pi"> Josep Rodriguez </a>是华盛顿州西雅图安全公司 IOActive 的研究员和顾问，他花了一年时间寻找自动取款机和销售点系统中使用的 NFC 读卡器的漏洞。世界各地的许多自动取款机都允许你轻敲借记卡或信用卡，然后输入你的个人识别码并提取现金，而不是要求你把它插入自动取款机本身。虽然它更方便，但它也避免了读卡器上存在物理套卡器的问题。在这一点上，销售点系统上的非接触式支付也无处不在。</p>
<div class="body-img landscape"><div class="responsive-img image-expandable img-article-item" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2021/06/Google-Pay.jpg" data-modal-id="single-image-modal" data-modal-container-id="single-image-modal-container" data-img-caption="&quot;Source: &lt;a href=\&quot;https:\/\/blog.google\/products\/google-pay\/easier-commute-google-pay-assistant\/\&quot;&gt;Google&lt;\/a&gt;&quot;">
 
<figure> <picture>  <source media="(min-width: 1024px)" sizes="1500px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2021/06/Google-Pay.jpg?q=50&amp;fit=crop&amp;w=1500&amp;dpr=1.5"/> <source media="(min-width: 768px)" sizes="943px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2021/06/Google-Pay.jpg?q=50&amp;fit=crop&amp;w=943&amp;dpr=1.5"/> <source media="(min-width: 481px)" sizes="767px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2021/06/Google-Pay.jpg?q=50&amp;fit=crop&amp;w=767&amp;dpr=1.5"/> <source media="(min-width: 0px)" sizes="480px" data-srcset="https://static1.xdaimages.com/wordpress/wp-content/uploads/2021/06/Google-Pay.jpg?q=50&amp;fit=crop&amp;w=480&amp;dpr=1.5"/> <img class="lazyload" alt="Google Pay being used for commuting" data-img-url="https://static1.xdaimages.com/wordpress/wp-content/uploads/2021/06/Google-Pay.jpg" src="../Images/5710e71db0c058b89f7131cbb3931c2b.png" data-original-src="https://static1.xdaimages.com/wordpress/wp-content/uploads/2021/06/Google-Pay.jpg"/> </picture> <figcaption class="body-img-caption">Source: <a href="https://blog.google/products/google-pay/easier-commute-google-pay-assistant/">Google</a></figcaption> </figure> </div>


 </div>



<h2 id="hacking-nfc-readers">入侵 NFC 阅读器</h2>
<p>Rodriquez 开发了一个 Android 应用程序，使他的手机能够模仿信用卡通信，并利用 NFC 系统固件中的缺陷。在 NFC 读卡器上挥动他的手机，他可以将多个漏洞链接在一起，使销售点设备崩溃，入侵它们以收集和传输卡数据，改变交易的价值，甚至用勒索病毒消息锁定设备。</p>

<p>此外，罗德里格斯说，他甚至可以迫使至少一个未命名的品牌的 ATM 机分发现金，尽管它只能与他在 ATM 机软件中发现的错误结合使用。这被称为“<a href="https://www.dieboldnixdorf.com/-/media/diebold/files/banking/insights/brochures/dn_brochure_security-jackpotting-overview_fa_20181005.pdf"> jackpotting </a>”，多年来，犯罪分子尝试了许多方法来进入 ATM，以窃取现金。由于与 ATM 供应商的保密协议，他拒绝透露品牌或方法。</p>

<p>例如，你可以修改固件，将价格改为一美元，即使屏幕显示你要支付 50 美元。你可以让设备失去作用，或者安装一种勒索软件。Rodriguez 在谈到他发现的销售点攻击时说:“。<em>“如果你将攻击串联起来，并向自动提款机的电脑发送一个特殊的有效载荷，你就可以像提现一样，通过轻击你的手机就能赢得自动提款机。”</em></p>

<p>资料来源:何塞普·罗德里格斯</p>

<p>受影响的供应商包括 ID Tech、Ingenico、Verifone、Crane Payment Innovations、BBPOS、Nexgo 和一家未具名的 ATM 供应商，所有这些供应商都在 7 个月到一年前收到了警报。然而，大多数销售点系统不接收软件更新或很少接收，并且很可能其中许多系统需要物理访问来进行更新。因此，很可能他们中的许多人仍然很脆弱。<em>“修补成千上万的自动取款机需要很多时间，”</em> Rodriguez 说。</p>

<p>为了展示这些漏洞，罗德里格斯与<em> Wired </em>分享了一段视频，显示他在马德里的一台 ATM 机上挥舞智能手机，导致机器显示一条错误信息。他没有展示 jackpotting 攻击，因为他只能在作为 IOActive 安全咨询的一部分获得的机器上合法地测试它，这将违反他们的保密协议。Rodriguez 要求<em> Wired </em>不要发布该视频，因为害怕承担法律责任。</p>

<p>安全公司 SRLabs 的创始人和固件黑客 Karsten Nohl 评论了 Rodriguez 的工作，他说，这些发现是“对嵌入式设备上运行的软件的漏洞的出色研究”。诺尔还提到，现实世界的小偷也有一些缺点，包括被黑的 NFC 读卡器只能让攻击者窃取磁条信用卡数据，而不是 EMV 芯片的 PIN 或数据。ATM jackpot 攻击还需要 ATM 固件中的漏洞，这是一个很大的障碍。</p>

<p>尽管如此，获得在这些机器上执行代码的权限本身就是一个主要的安全缺陷，并且通常是任何系统中的第一个入口点，即使它只不过是用户级的访问。一旦你通过了外部安全层，通常情况是内部软件系统远没有那么安全。</p>

<p>红气球首席执行官兼首席科学家崔昂对这一发现印象深刻。<em>“我认为很有可能的是，一旦你在这些设备上执行代码，你应该能够直接进入主控制器，因为它充满了十多年来一直没有得到修复的漏洞，”</em> Cui 说。<em/>他补充道，<em>【你完全可以控制卡式提款机】</em>提款机存放和释放现金给用户。</p>
<p class="ad-odd"> </p>


<h2 id="custom-code-execution">自定义代码执行</h2>
<p>在任何机器上执行自定义代码的能力是一个主要的漏洞，并使攻击者能够探测机器中的底层系统以找到更多的漏洞。任天堂 3DS 就是一个最好的例子:一款名为<em> Cubic Ninja </em>的游戏是开发 3DS 和执行自制程序的最早方式之一。该漏洞被称为“Ninjhax”，导致缓冲区溢出，从而触发自定义代码的执行。虽然游戏本身只有用户级别的系统访问权限，但 Ninjhax 成为了在 3DS 上运行定制固件的进一步利用的基础。</p>



<p>简而言之:当发送的数据量超过为该数据分配的存储空间时，就会触发缓冲区溢出，这意味着多余的数据会存储在相邻的内存区域中。如果相邻的内存区域可以执行代码，那么攻击者可以滥用这一点，用垃圾数据填充缓冲区，然后将可执行代码附加到它的末尾，在那里代码将被读入相邻的内存。并非所有的缓冲区溢出攻击都可以执行代码，许多攻击只会使程序崩溃或导致意外行为。例如，如果一个字段只能接受 8 个字节的数据，而攻击者强制输入了 10 个字节，那么最后额外的 2 个字节将溢出到内存的另一个区域。</p>

<p/><p><strong> <a href="https://www.xda-developers.com/linux-update-sudo-security-flaw/">阅读更多:《PSA:如果你的 PC 运行 Linux，你应该现在就更新 Sudo》</a></strong></p>

<p>Rodriguez 指出，对 NFC 阅读器和销售点设备的缓冲区溢出攻击是可能的，因为他去年从易贝购买了许多这样的设备。他指出，他们中的许多人都遭受了同样的安全缺陷:他们没有验证通过 NFC 从信用卡发送的数据的大小。如果应用程序发送的数据比读者预期的大几百倍，就有可能引发缓冲区溢出。</p>

<p>当<em> Wired </em>联系受影响的公司寻求置评时，ID Tech、BBPOS 和 Nexgo 没有回应置评请求。ATM 行业协会也拒绝置评。Ingenico 在一份声明中回应说，安全缓解措施意味着 Rodriguez 的缓冲区溢出只能使设备崩溃，而不能获得自定义代码的执行。Rodriguez 怀疑他们是否真的会阻止代码执行，但却没有创建概念证明来演示。Ingenico 表示，“考虑到给我们的客户带来的不便和影响”，它无论如何都会发布一个修复程序。</p>

<p>Verifone 表示，在报告之前，它已经在 2018 年发现并修复了销售点漏洞，尽管这只是表明这些设备从未更新。罗德里格斯说，去年他在一家餐馆的 Verifone 设备上测试了他的 NFC 攻击，发现它仍然容易受到攻击。</p>

<p><em>“这些漏洞在固件中已经存在多年了，我们每天都在使用这些设备处理我们的信用卡和金钱，”</em> Rodriguez 说。<em>“他们需要被保护。”</em> Rodriguez 计划在未来几周的网络研讨会上分享这些漏洞的技术细节。</p>

 </div>


</div>    
</body>
</html>