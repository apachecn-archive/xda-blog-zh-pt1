<html>
<head>
<title>Why Facebook's outage shut many employees out of their own offices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>为什么脸书的停电让许多员工无法进入自己的办公室</h1>
<blockquote>原文：<a href="https://www.xda-developers.com/facebook-outage-explanation/#0001-01-01">https://www.xda-developers.com/facebook-outage-explanation/#0001-01-01</a></blockquote><div><div class="content-block-regular">
<p/><p>脸书、Instagram 和 WhatsApp <a href="https://www.xda-developers.com/facebook-messenger-instagram-whatsapp-outage/">都在昨天</a>关闭了。你可能听说过这件事，因为不仅仅是这三个<em>大型</em>服务被关闭了六个小时，而且其他一些网站也被关闭了。这也导致了一些来自脸书的幽默信息，包括多名脸书员工因此被关在办公室门外的事实。到底发生了什么？</p>

 
<h2 id="understanding-border-gateway-protocol-bgp">了解边界网关协议(BGP)</h2>
<p>为了解释脸书问题的基本概念，很多内容都被简化和删减了。如果你想要一份完全深入的技术分析，包括来自他们自己的 DNS 的数据，Cloudflare 有一篇关于整个情况的精彩技术文章。</p>

<p>每当你访问一个网站时，你输入的由字母和数字组成的人类可读域实际上并不是直接将你连接到你想访问的网站的。相反，它们映射到域名服务器为您找到的 IP 地址。比这更大、更重要的是 BGP，它代表边界网关协议。这种机制有效地充当了在互联网上的自治系统之间路由信息的交换。它实际上是更广泛的互联网的主干，将所有这些联系在一起，并且是一个网络可以向其他网络宣传其存在的方式。</p>

<p>当我们使用互联网时，我们正在与成千上万的互联网服务提供商、路由器和服务器进行交互。你访问的每一个网站，每一个在后台路由的连接，它们都与几个互不相关的系统有联系。BGP 有效地向您的计算机或智能手机或任何其他设备显示到达目的地的最佳方式。BGP 的部分工作也是寻找从你的设备到你的目的地的最佳路径。</p>

<p>BGP 特别连接自治系统，并且这些自治系统由单一实体拥有并且具有它们自己的网络。他们可以是互联网服务提供商、大公司，甚至是大学。我上个月从都柏林大学毕业，它有自己的自治系统，是 1993 年分配的。这些系统的信息是公开的。</p>



<p>问题是，互联网是一个活生生的存在。这些网络不断更新，自治系统每时每刻都互相共享自己的网络。这个网络是由不同的自治系统建立起来的，它们相互交流并创建自己的互联网地图。众所周知，<a href="https://blog.cdemi.io/beginners-guide-to-understanding-bgp/">当巴基斯坦政府在 2008 年试图禁止 YouTube</a>时，它使用 BGP 将 YouTube 路由到一个黑洞。因为这与复制该配置的其他自治系统共享，几乎所有 YouTube 的流量都被路由到巴基斯坦的一个黑洞中。YouTube 本身完全没问题，但滥用 BGP 路由有效地暂时扼杀了该网站。</p>

 
<p class="w-rich w-youtube" id="IzLPKuAOe50">  </p>

<p class="ad-odd"> </p>


<h2 id="facebook-s-part-to-play">脸书要扮演的角色</h2>
<p>问题在于:脸书运营着自己的一套域名服务器。这些负责告诉你的互联网服务提供商和这条路线上的所有中介“facebook”(以及该公司的所有其他产品，如 Instagram 和 WhatsApp)实际上在哪里。脸书停止向其自己的域名服务器广播 BGP 路由信息，这些服务器向全世界的自治系统广播该信息。这意味着脸书实际上已经脱离了互联网。网络安全记者布莱恩·克雷布斯(Brian Krebs)表示，这似乎是“例行的 BGP 更新出错了”。</p>

 



<p>在脸书最初的验尸报告中，它说:</p>

<blockquote>
<p/><h4>我们的工程团队了解到，协调数据中心之间网络流量的主干路由器上的配置变化导致了中断通信的问题。这种网络流量中断对我们数据中心的通信方式产生了级联效应，导致我们的服务停止。</h4>
 </blockquote>
<p>随后，该公司对情况的更深入的分析提供了更多的信息。</p>

<blockquote>
<p/><h4>在其中一次例行维护工作中，发出了一个旨在评估全球主干网容量可用性的命令，这无意中导致主干网中的所有连接中断，从而有效地断开了脸书全球数据中心的连接。</h4>
 </blockquote>
<p>脸书接着解释说，当他们的 DNS 服务器无法与他们的数据中心对话时，他们会撤回 BGP 广告。这就是脸书与世隔绝的原因，也是它的域名系统完全无法访问的原因。该公司还谈到工程师如何难以到达现场解决问题，这是有道理的，因为多份报告谈到脸书员工甚至进入他们的办公室都有问题。</p>

 


<p class="ad-even"> </p>


<h2 id="global-ramifications">全球影响</h2>
<p>Cloudflare 出色的报道详细介绍了它注意到的一些问题，以及脸书宕机导致的一些后果。Cloudflare 运营着自己的 DNS 1.1.1.1，该提供商发现脸书自己的网站停止了解析。事实上，他们担心这是他们系统的问题。脸书已停止向其 DNS 广播路由信息，这意味着其 DNS 不可用。</p>

<p>当脸书停止广播路由时，DNS 解析器陷入混乱。在尝试不断重新连接到脸书的应用程序之间，以及人类行为也导致垃圾邮件流向脸书的服务器之间，额外 DNS 流量的“海啸”袭击了 Cloudflare 的服务器。</p>



<p>有趣的是，一些华为设备所有者指出，他们也无法再连接 Wi-Fi 网络。有可能华为正在以某种方式使用脸书的服务器来验证互联网连接是否活跃。这也可能是一个不幸的巧合。</p>

<p>尽管如此，情况还是变得更糟了。当脸书关闭时，Cloudflare 注意到对 Twitter、Signal、Telegram 和抖音等其他平台的查询增加了。Twitter 也开始在重压之下挣扎，在短暂的几分钟内，许多人认为它也会倒下。</p>

 



<p>使用脸书单点登录的网站也遇到了问题，因为许多用户甚至无法登录。整个互联网在许多方面都遇到了问题，全球各地的服务都在抱怨。几个小时后，脸书重新上线。</p>

<p>如果这整个崩溃证明了一件事，那就是电子前沿基金会的网络安全主管 Eva Galperin 所说的:“互联网是用泡泡糖和绳子连在一起的”。</p>

 </div>


</div>    
</body>
</html>